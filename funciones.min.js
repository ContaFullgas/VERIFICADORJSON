const _0x11a336=_0x170e;function _0x170e(e,$){let x=_0x5b91();return(_0x170e=function(e,$){return x[e-=463]})(e,$)}!function(e,$){let x=_0x170e,a=e();for(;;)try{let r=parseInt(x(518))/1+parseInt(x(560))/2+-parseInt(x(515))/3+parseInt(x(549))/4+-parseInt(x(497))/5+parseInt(x(496))/6*(parseInt(x(580))/7)+-parseInt(x(550))/8;if(490483===r)break;a.push(a.shift())}catch(_){a.push(a.shift())}}(_0x5b91,490483);let file;const adjuntarArchivo=document[_0x11a336(475)]("adjuntarArchivo");adjuntarArchivo[_0x11a336(527)](_0x11a336(517),()=>{let e=_0x11a336;file=adjuntarArchivo.files[0],console.log(file[e(534)]),validarNombreDeArchivoZip()});const dropAreaImpresion=document[_0x11a336(475)](_0x11a336(507)),adjuntarArchivoImpresion=document[_0x11a336(475)]("adjuntarArchivo");function _0x5b91(){let e=["sumaVolumenVentas","SEY0704139A8","CACX7605101P8","oculto","ValorNumerico","4187502tpftcj","3935840mcpijQ","volumenComprasDiesel","nombreArchivoImpreso","El nombre del archivo no termina en JSON.zip","volumenComprasPremium",'<div class="celda fw-bold border rounded-2 d-flex justify-content-start mt-3 mb-3 p-2" style="background-color: #d90429; font-family: sans-serif;">',"readAsArrayBuffer","keys","LA FECHA DEL ARCHIVO ES: ","innerHTML","dropArea","reload","SEC141031S67","find","text","long","NumPermiso","Aceptar","1501059kZTAeX","loadAsync","change","725693cIsPmI","log","endsWith","SEM1410318Q5","Entregas","SEC150204U97","SEC20082165A","Caracter","#0087F7","addEventListener","isConfirmed","El archivo no es de tipo zip","dragover","Esto podr\xeda perder tu progreso actual.","then","target","name","No se encontr\xf3 un archivo JSON en el ZIP.","importeVentasPremium","add","SumaVolumenEntregadoMes","files","MAGNA","dataTransfer","style","SEM150204RK4","PREMIUM","listadoErorresNombreArchivo","parse","DOMContentLoaded","textContent","3613784NoBIPl","7451784yagdBe","erroresTitulo",".json","toUpperCase","premiumTitulo","numeroDispensarios","RFC del proveedor","RfcContribuyente","Identificador del tipo de documento","toFixed","764842lbbtGu","SEM070413TA9","caracterPermisos","remove","ImporteTotalEntregasMes","Error al procesar el archivo ZIP o JSON.","onload","sumaImporteVentas","</div>","SumaVolumenRecepcionMes","camposTablaErroresNombreJson","classList","borderColor","Recepciones","AET1404031U2","Por favor, sube un archivo ZIP v\xe1lido.","SEB151218B36","async","NumeroDispensarios",".zip","7cuiTsh","ReporteDeVolumenMensual","Identificador de envio","file","SEM141031V5A","fechaDelArchivo","RFC del contribuyente","SER150303GN5","preventDefault","match","drop","numPermiso","numeric","rfcContribuyente","getElementById","magnaTitulo","rfcProveedor","Cancelar","MarcaComercial","split","CGM130531NS2","Producto","scrollTo","length","#005BB5","DIESEL","push","warning","reduce","SYU110901LR9"];return(_0x5b91=function(){return e})()}erroresTitulo=document[_0x11a336(475)](_0x11a336(551)),listadoErorresNombreArchivo=document[_0x11a336(475)](_0x11a336(545));const fechaDelArchivo=document.getElementById(_0x11a336(466)),sumaVolumenCompras=document[_0x11a336(475)]("sumaVolumenCompras"),sumaVolumenVentas=document[_0x11a336(475)](_0x11a336(491)),sumaImporteVentas=document[_0x11a336(475)](_0x11a336(567)),dieselTitulo=document.getElementById("dieselTitulo"),volumenComprasDieselImpresion=document[_0x11a336(475)](_0x11a336(498)),volumenVentasDieselImpresion=document.getElementById("volumenVentasDiesel"),importeVentasDieselImpresion=document[_0x11a336(475)]("importeVentasDiesel"),magnaTitulo=document[_0x11a336(475)](_0x11a336(476)),volumenComprasMagnaImpresion=document[_0x11a336(475)]("volumenComprasMagna"),volumenVentasMagnaImpresion=document[_0x11a336(475)]("volumenVentasMagna"),importeVentasMagnaImpresion=document[_0x11a336(475)]("importeVentasMagna"),premiumTitulo=document[_0x11a336(475)](_0x11a336(554)),volumenComprasPremiumImpresion=document[_0x11a336(475)](_0x11a336(501)),volumenVentasPremiumImpresion=document.getElementById("volumenVentasPremium"),importeVentasPremiumImpresion=document[_0x11a336(475)](_0x11a336(536)),rfcContribuyenteImpresion=document.getElementById(_0x11a336(474)),rfcProveedorImpresion=document.getElementById(_0x11a336(477)),numPermisoImpresion=document[_0x11a336(475)](_0x11a336(472)),caracterPermisoImpresion=document[_0x11a336(475)](_0x11a336(562)),numeroDispensariosImpresion=document.getElementById(_0x11a336(555)),nombreArchivoImpreso=document[_0x11a336(475)](_0x11a336(499));var arrayDeCadenas=[],arrayFechaCadenas=[],arrayErroresNombreArchivo=[],arrayRFC_contribuyente=[_0x11a336(521),"SEC150112537","SES150112RC3","SEM1512187Y9",_0x11a336(576),_0x11a336(509),_0x11a336(524),"JGE900406818",_0x11a336(492),_0x11a336(493),_0x11a336(481),"CARJ521227GH5","SEC1503037FA",_0x11a336(465),"SES150112RC3",_0x11a336(574),_0x11a336(490),"SEI1410319R7",_0x11a336(523),_0x11a336(468),_0x11a336(561),_0x11a336(543)];function validarNombreDeArchivoZip(){let e=_0x11a336;file.name[e(520)](e(579))||(alert(e(529)),location[e(508)]());var $=file[e(534)];if(dividirCadena($,"_"),"M"!==arrayDeCadenas[0]&&"D"!==arrayDeCadenas[0]&&arrayErroresNombreArchivo[e(487)](e(558)),36!==arrayDeCadenas[1][e(484)]&&arrayErroresNombreArchivo[e(487)](e(463)),12!==arrayDeCadenas[2].length&&13!==arrayDeCadenas[2][e(484)]&&arrayErroresNombreArchivo[e(487)](e(467)),12!==arrayDeCadenas[3].length&&13!==arrayDeCadenas[3][e(484)]&&arrayErroresNombreArchivo[e(487)](e(556)),dividirCadenaFecha(arrayDeCadenas[4],"-"),esFechaValida(arrayFechaCadenas)||arrayErroresNombreArchivo[e(487)]("Fecha invalida"),contarCaracteresAlfanumericos(arrayDeCadenas[5])||arrayErroresNombreArchivo.push("Clave de instalacion"),contarCaracteresClaves(arrayDeCadenas[6])||arrayErroresNombreArchivo[e(487)]("Clave de tipo de reporte"),"JSON.zip"!==arrayDeCadenas[7]&&arrayErroresNombreArchivo.push(e(500)),console[e(519)](arrayDeCadenas),console[e(519)](arrayErroresNombreArchivo),0==arrayErroresNombreArchivo)accederAlZipYLeerJson();else{for(var x="",a=0;a<arrayErroresNombreArchivo[e(484)];a++)x+=e(502)+arrayErroresNombreArchivo[a]+e(568);document[e(475)](e(570))[e(506)]=x,dropArea[e(571)][e(537)](e(494)),adjuntarArchivoImpresion.classList[e(537)](e(494)),tablaDatosJson[e(571)].add("oculto"),tablaErroresNombreJson[e(571)][e(563)](e(494)),botonReiniciarPagina[e(571)].remove(e(494))}}function accederAlZipYLeerJson(){let e=_0x11a336;if(file&&file[e(534)][e(520)](e(579))){let $=new FileReader;$[e(566)]=async $=>{let x=e;try{let a=await JSZip[x(516)]($[x(533)].result),r=Object[x(504)](a[x(539)])[x(510)](e=>e[x(520)](x(552)));if(r){let _=await a[x(464)](r)[x(577)](x(511)),o=JSON[x(546)](_),n=o[x(482)][x(489)]((e,$)=>{let a=x;return e+$[a(581)][a(573)][a(569)].ValorNumerico},0)[x(559)](3),t=o[x(482)][x(489)]((e,$)=>{let a=x;return e+$[a(581)].Entregas.SumaVolumenEntregadoMes[a(495)]},0)[x(559)](3),i=o[x(482)][x(489)]((e,$)=>{let a=x;return e+$.ReporteDeVolumenMensual[a(522)][a(564)]},0).toFixed(3),s=o[x(482)][x(510)](e=>e.MarcaComercial[x(553)]()===x(486))?.ReporteDeVolumenMensual.Recepciones[x(569)][x(495)],m=o.Producto[x(510)](e=>e[x(479)][x(553)]()===x(486))?.[x(581)][x(522)][x(538)][x(495)],d=o[x(482)].find(e=>e[x(479)][x(553)]()===x(486))?.[x(581)].Entregas[x(564)],c=o[x(482)][x(510)](e=>e[x(479)][x(553)]()===x(540))?.ReporteDeVolumenMensual[x(573)].SumaVolumenRecepcionMes[x(495)],l=o.Producto.find(e=>e[x(479)].toUpperCase()===x(540))?.[x(581)].Entregas[x(538)][x(495)],u=o[x(482)].find(e=>e[x(479)].toUpperCase()===x(540))?.[x(581)][x(522)][x(564)],f=o[x(482)].find(e=>e[x(479)][x(553)]()===x(544))?.[x(581)][x(573)].SumaVolumenRecepcionMes.ValorNumerico,p=o[x(482)][x(510)](e=>"PREMIUM"===e[x(479)].toUpperCase())?.[x(581)][x(522)][x(538)][x(495)],v=o[x(482)][x(510)](e=>e.MarcaComercial[x(553)]()===x(544))?.[x(581)][x(522)].ImporteTotalEntregasMes,C=o[x(557)],b=o[x(513)],h=o[x(525)],E=o[x(578)],y=o.RfcProveedor;fechaDelArchivo[x(548)]=x(505)+arrayDeCadenas[4],sumaVolumenCompras[x(548)]=n,sumaVolumenVentas.textContent=t,sumaImporteVentas.textContent=i,volumenComprasDieselImpresion[x(548)]=s,volumenVentasDieselImpresion[x(548)]=m,importeVentasDieselImpresion[x(548)]=d,volumenComprasMagnaImpresion[x(548)]=c,volumenVentasMagnaImpresion[x(548)]=l,importeVentasMagnaImpresion[x(548)]=u,volumenComprasPremiumImpresion[x(548)]=f,volumenVentasPremiumImpresion.textContent=p,importeVentasPremiumImpresion[x(548)]=v,rfcContribuyenteImpresion[x(548)]=C,rfcProveedorImpresion.textContent=y,numPermisoImpresion.textContent=b,caracterPermisoImpresion[x(548)]=h,numeroDispensariosImpresion[x(548)]=E,nombreArchivoImpreso[x(548)]=file[x(534)],dropArea.classList[x(537)](x(494)),tablaDatosJson[x(571)][x(563)](x(494)),botonReiniciarPagina[x(571)][x(563)](x(494))}else alert(x(535)),location[x(508)]()}catch(I){alert(x(565),I),location[x(508)]()}},$[e(503)](file)}else alert(e(575)),location.reload()}function actualizarPagina(){let e=_0x11a336;Swal.fire({title:"\xbfQuieres reiniciar?",text:e(531),icon:e(488),showCancelButton:!0,confirmButtonText:e(514),cancelButtonText:e(478)})[e(532)]($=>{let x=e;$[x(528)]&&location[x(508)]()})}function getCurrentDate(){let e=_0x11a336,$={year:e(473),month:e(512),day:e(473)},x=new Date().toLocaleDateString("es-ES",$);document[e(475)]("current-date").innerText=x}function dividirCadenaFecha(e,$){arrayFechaCadenas=e.split($)}function esFechaValida(e){if(3!==e[_0x11a336(484)])return!1;let $=parseInt(e[0],10),x=parseInt(e[1],10),a=parseInt(e[2],10);return!(isNaN($)||isNaN(x)||isNaN(a))&&!($<0)&&!(x<1)&&!(x>12)&&a>=1&&a<=[31,$%4==0&&($%100!=0||$%400==0)?29:28,31,30,31,30,31,31,30,31,30,31][x-1]}function dividirCadena(e,$){arrayDeCadenas=e[_0x11a336(480)]($)}function contarCaracteresAlfanumericos(e){let $=_0x11a336,x=e[$(470)](/[a-zA-Z]/g),a=e[$(470)](/\d/g);return 3==x[$(484)]&&4==a.length&&x&&a}function contarCaracteresClaves(e){let $=e[_0x11a336(470)](/[a-zA-Z]/g);return 3==$.length&&$}dropArea[_0x11a336(527)](_0x11a336(530),e=>{let $=_0x11a336;e[$(469)](),dropArea[$(542)][$(572)]=$(485)}),dropArea.addEventListener("dragleave",()=>{let e=_0x11a336;dropArea[e(542)][e(572)]=e(526)}),dropArea[_0x11a336(527)](_0x11a336(471),e=>{let $=_0x11a336;e[$(469)](),dropArea[$(542)][$(572)]=$(526),file=e[$(541)][$(539)][0],validarNombreDeArchivoZip()}),document[_0x11a336(527)](_0x11a336(547),function(){window[_0x11a336(483)](0,0)}),getCurrentDate();